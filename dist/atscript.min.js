!function(e){var t={};function s(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";var n,r;s.r(t),function(e){e[e.Eof=0]="Eof",e[e.Panic=1]="Panic",e[e.Lambda=2]="Lambda",e[e.Ampersand=3]="Ampersand",e[e.AtSign=4]="AtSign",e[e.Caret=5]="Caret",e[e.Comma=6]="Comma",e[e.Dollar=7]="Dollar",e[e.Dot=8]="Dot",e[e.Hash=9]="Hash",e[e.LeftBrace=10]="LeftBrace",e[e.LeftBracket=11]="LeftBracket",e[e.LeftParen=12]="LeftParen",e[e.Percent=13]="Percent",e[e.Pipe=14]="Pipe",e[e.RightBrace=15]="RightBrace",e[e.RightBracket=16]="RightBracket",e[e.RightParen=17]="RightParen",e[e.Semicolon=18]="Semicolon",e[e.Slash=19]="Slash",e[e.Star=20]="Star",e[e.Arrow=21]="Arrow",e[e.Bang=22]="Bang",e[e.BangEqual=23]="BangEqual",e[e.Colon=24]="Colon",e[e.Equal=25]="Equal",e[e.EqualEqual=26]="EqualEqual",e[e.Greater=27]="Greater",e[e.GreaterEqual=28]="GreaterEqual",e[e.Less=29]="Less",e[e.LessEqual=30]="LessEqual",e[e.Minus=31]="Minus",e[e.MinusEqual=32]="MinusEqual",e[e.MinusMinus=33]="MinusMinus",e[e.PercentEqual=34]="PercentEqual",e[e.Plus=35]="Plus",e[e.PlusEqual=36]="PlusEqual",e[e.PlusPlus=37]="PlusPlus",e[e.Question=38]="Question",e[e.QuestionDot=39]="QuestionDot",e[e.QuestionQuestion=40]="QuestionQuestion",e[e.SlashEqual=41]="SlashEqual",e[e.StarEqual=42]="StarEqual",e[e.Identifier=43]="Identifier",e[e.Template=44]="Template",e[e.String=45]="String",e[e.Number=46]="Number",e[e.Regex=47]="Regex",e[e.And=48]="And",e[e.Break=49]="Break",e[e.Base=50]="Base",e[e.Class=51]="Class",e[e.Continue=52]="Continue",e[e.Do=53]="Do",e[e.Else=54]="Else",e[e.Extends=55]="Extends",e[e.False=56]="False",e[e.For=57]="For",e[e.Function=58]="Function",e[e.If=59]="If",e[e.In=60]="In",e[e.Instanceof=61]="Instanceof",e[e.Is=62]="Is",e[e.New=63]="New",e[e.Null=64]="Null",e[e.Or=65]="Or",e[e.Print=66]="Print",e[e.Return=67]="Return",e[e.True=68]="True",e[e.Typeof=69]="Typeof",e[e.Var=70]="Var",e[e.Void=71]="Void",e[e.While=72]="While"}(n||(n={}));class i{constructor(e,t,s,r,i){this.name=n[e],this.type=e,this.lexeme=t,this.literal=s,this.line=r,this.col=i}toString(){return`[(${this.line}):"${this.lexeme}"]`}}function a(e){return e>="0"&&e<="9"}function o(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}function u(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}class l{scan(e){for(this.source=e,this.tokens=[],this.errors=[],this.current=0,this.start=0,this.line=1,this.col=1;!this.eof();){this.start=this.current;try{this.getToken()}catch(e){if(this.errors.push(e.message),this.errors.length>100)return this.errors.push("Error limit exceeded"),this.tokens}}return this.tokens.push(new i(n.Eof,"",null,this.line,0)),this.tokens}eof(){return this.current>=this.source.length}advance(){return"\n"===this.peek()&&(this.line++,this.col=0),this.current++,this.col++,this.source.charAt(this.current-1)}addToken(e,t){const s=this.source.substring(this.start,this.current);this.tokens.push(new i(e,s,t,this.line,this.col))}match(e){return!this.eof()&&(this.source.charAt(this.current)===e&&(this.current++,!0))}peek(){return this.eof()?"\0":this.source.charAt(this.current)}peekNext(){return this.current+1>=this.source.length?"\0":this.source.charAt(this.current+1)}comment(){for(;"\n"!==this.peek()&&!this.eof();)this.advance()}multilineComment(){for(;!this.eof()&&("*"!==this.peek()||"/"!==this.peekNext());)this.advance();this.eof()?this.error('Unterminated comment, expecting closing "*/"'):(this.advance(),this.advance())}string(e){for(;this.peek()!==e&&!this.eof();)this.advance();if(this.eof())return void this.error(`Unterminated string, expecting closing ${e}`);this.advance();const t=this.source.substring(this.start+1,this.current-1);this.addToken("`"!==e?n.String:n.Template,t)}number(){for(;a(this.peek());)this.advance();for("."===this.peek()&&a(this.peekNext())&&this.advance();a(this.peek());)this.advance();for("e"===this.peek().toLowerCase()&&(this.advance(),"-"!==this.peek()&&"+"!==this.peek()||this.advance());a(this.peek());)this.advance();const e=this.source.substring(this.start,this.current);this.addToken(n.Number,Number(e))}identifier(){for(;o(e=this.peek())||a(e);)this.advance();var e;const t=this.source.substring(this.start,this.current),s=u(t);n[s]>=n.And?this.addToken(n[s],t):this.addToken(n.Identifier,t)}getToken(){const e=this.advance();switch(e){case"(":this.addToken(n.LeftParen,null);break;case")":this.addToken(n.RightParen,null);break;case"[":this.addToken(n.LeftBracket,null);break;case"]":this.addToken(n.RightBracket,null);break;case"{":this.addToken(n.LeftBrace,null);break;case"}":this.addToken(n.RightBrace,null);break;case",":this.addToken(n.Comma,null);break;case".":this.addToken(n.Dot,null);break;case";":this.addToken(n.Semicolon,null);break;case"^":this.addToken(n.Caret,null);break;case":":this.addToken(n.Colon,null);break;case"$":this.addToken(n.Dollar,null);break;case"@":this.addToken(n.Function,"@");break;case"*":this.addToken(this.match("=")?n.StarEqual:n.Star,null);break;case"%":this.addToken(this.match("=")?n.PercentEqual:n.Percent,null);break;case"|":this.addToken(this.match("|")?n.Or:n.Pipe,null);break;case"&":this.addToken(this.match("&")?n.And:n.Ampersand,null);break;case"<":this.addToken(this.match("=")?n.LessEqual:n.Less,null);break;case">":this.addToken(this.match("=")?n.GreaterEqual:n.Greater,null);break;case"!":this.addToken(this.match("=")?n.BangEqual:n.Bang,null);break;case"?":this.addToken(this.match("?")?n.QuestionQuestion:this.match(".")?n.QuestionDot:n.Question,null);break;case"=":this.addToken(this.match("=")?n.EqualEqual:this.match(">")?n.Arrow:n.Equal,null);break;case"+":this.addToken(this.match("+")?n.PlusPlus:this.match("=")?n.PlusEqual:n.Plus,null);break;case"-":this.addToken(this.match("-")?n.MinusMinus:this.match(">")?n.Return:this.match("=")?n.MinusEqual:n.Minus,null);break;case"/":this.match("/")?this.comment():this.match("*")?this.multilineComment():this.addToken(this.match("=")?n.SlashEqual:n.Slash,null);break;case"'":case'"':case"`":this.string(e);break;case"\n":case" ":case"\r":case"\t":break;default:a(e)?this.number():o(e)?this.identifier():this.error(`Unexpected character '${e}'`)}}error(e){throw new Error(`Scan Error (${this.line}:${this.col}) => ${e}`)}}class c{constructor(){}}class h extends c{constructor(e,t,s){super(),this.name=e,this.value=t,this.line=s}accept(e){return e.visitAssignExpr(this)}toString(){return"Expr.Assign"}}class p extends c{constructor(e,t){super(),this.paren=e,this.line=t}accept(e){return e.visitBaseExpr(this)}toString(){return"Expr.Base"}}class m extends c{constructor(e,t,s,n){super(),this.left=e,this.operator=t,this.right=s,this.line=n}accept(e){return e.visitBinaryExpr(this)}toString(){return"Expr.Binary"}}class d extends c{constructor(e,t,s,n,r){super(),this.callee=e,this.paren=t,this.args=s,this.thiz=n,this.line=r}accept(e){return e.visitCallExpr(this)}toString(){return"Expr.Call"}}class v extends c{constructor(e,t){super(),this.properties=e,this.line=t}accept(e){return e.visitDictionaryExpr(this)}toString(){return"Expr.Dictionary"}}class f extends c{constructor(e,t,s,n){super(),this.entity=e,this.key=t,this.type=s,this.line=n}accept(e){return e.visitGetExpr(this)}toString(){return"Expr.Get"}}class w extends c{constructor(e,t){super(),this.expression=e,this.line=t}accept(e){return e.visitGroupingExpr(this)}toString(){return"Expr.Grouping"}}class x extends c{constructor(e,t,s){super(),this.key=e,this.entity=t,this.line=s}accept(e){return e.visitInExpr(this)}toString(){return"Expr.In"}}class g extends c{constructor(e,t,s){super(),this.left=e,this.right=t,this.line=s}accept(e){return e.visitInstanceOfExpr(this)}toString(){return"Expr.InstanceOf"}}class E extends c{constructor(e,t,s){super(),this.left=e,this.right=t,this.line=s}accept(e){return e.visitIsExpr(this)}toString(){return"Expr.Is"}}class S extends c{constructor(e,t){super(),this.name=e,this.line=t}accept(e){return e.visitKeyExpr(this)}toString(){return"Expr.Key"}}class y extends c{constructor(e,t){super(),this.lambda=e,this.line=t}accept(e){return e.visitLambdaExpr(this)}toString(){return"Expr.Lambda"}}class k extends c{constructor(e,t,s,n){super(),this.left=e,this.operator=t,this.right=s,this.line=n}accept(e){return e.visitLogicalExpr(this)}toString(){return"Expr.Logical"}}class b extends c{constructor(e,t){super(),this.value=e,this.line=t}accept(e){return e.visitListExpr(this)}toString(){return"Expr.List"}}class P extends c{constructor(e,t){super(),this.value=e,this.line=t}accept(e){return e.visitLiteralExpr(this)}toString(){return"Expr.Literal"}}class L extends c{constructor(e,t){super(),this.clazz=e,this.line=t}accept(e){return e.visitNewExpr(this)}toString(){return"Expr.New"}}class B extends c{constructor(e,t,s){super(),this.left=e,this.right=t,this.line=s}accept(e){return e.visitNullCoalescingExpr(this)}toString(){return"Expr.NullCoalescing"}}class C extends c{constructor(e,t,s){super(),this.name=e,this.increment=t,this.line=s}accept(e){return e.visitPostfixExpr(this)}toString(){return"Expr.Postfix"}}class R extends c{constructor(e,t,s,n){super(),this.start=e,this.end=t,this.step=s,this.line=n}accept(e){return e.visitRangeExpr(this)}toString(){return"Expr.Range"}}class q extends c{constructor(e,t){super(),this.value=e,this.line=t}accept(e){return e.visitRegExExpr(this)}toString(){return"Expr.RegEx"}}class T extends c{constructor(e,t,s,n){super(),this.entity=e,this.key=t,this.value=s,this.line=n}accept(e){return e.visitSetExpr(this)}toString(){return"Expr.Set"}}class $ extends c{constructor(e,t){super(),this.value=e,this.line=t}accept(e){return e.visitTemplateExpr(this)}toString(){return"Expr.Template"}}class M extends c{constructor(e,t,s,n){super(),this.condition=e,this.thenExpr=t,this.elseExpr=s,this.line=n}accept(e){return e.visitTernaryExpr(this)}toString(){return"Expr.Ternary"}}class N extends c{constructor(e,t){super(),this.value=e,this.line=t}accept(e){return e.visitTypeofExpr(this)}toString(){return"Expr.Typeof"}}class I extends c{constructor(e,t,s){super(),this.operator=e,this.right=t,this.line=s}accept(e){return e.visitUnaryExpr(this)}toString(){return"Expr.Unary"}}class D extends c{constructor(e,t){super(),this.name=e,this.line=t}accept(e){return e.visitVariableExpr(this)}toString(){return"Expr.Variable"}}class O extends c{constructor(e,t){super(),this.value=e,this.line=t}accept(e){return e.visitVoidExpr(this)}toString(){return"Expr.Void"}}class z extends c{constructor(e,t){super(),this.value=e,this.line=t}accept(e){return e.visitZtringExpr(this)}toString(){return"Expr.Ztring"}}class A{constructor(){}}class F extends A{constructor(e,t){super(),this.statements=e,this.line=t}accept(e){return e.visitBlockStmt(this)}toString(){return"Stmt.Block"}}class j extends A{constructor(e,t){super(),this.keyword=e,this.line=t}accept(e){return e.visitBreakStmt(this)}toString(){return"Stmt.Break"}}class V extends A{constructor(e,t,s,n){super(),this.name=e,this.parent=t,this.methods=s,this.line=n}accept(e){return e.visitClassStmt(this)}toString(){return"Stmt.Class"}}class U extends A{constructor(e,t){super(),this.keyword=e,this.line=t}accept(e){return e.visitContinueStmt(this)}toString(){return"Stmt.Continue"}}class G extends A{constructor(e,t,s){super(),this.loop=e,this.condition=t,this.line=s}accept(e){return e.visitDoWhileStmt(this)}toString(){return"Stmt.DoWhile"}}class Q extends A{constructor(e,t){super(),this.expression=e,this.line=t}accept(e){return e.visitExpressionStmt(this)}toString(){return"Stmt.Expression"}}class W extends A{constructor(e,t,s,n){super(),this.name=e,this.params=t,this.body=s,this.line=n}accept(e){return e.visitFuncStmt(this)}toString(){return"Stmt.Func"}}class K extends A{constructor(e,t,s,n){super(),this.condition=e,this.thenStmt=t,this.elseStmt=s,this.line=n}accept(e){return e.visitIfStmt(this)}toString(){return"Stmt.If"}}class _ extends A{constructor(e,t){super(),this.expression=e,this.line=t}accept(e){return e.visitPrintStmt(this)}toString(){return"Stmt.Print"}}class Z extends A{constructor(e,t,s){super(),this.keyword=e,this.value=t,this.line=s}accept(e){return e.visitReturnStmt(this)}toString(){return"Stmt.Return"}}class H extends A{constructor(e,t,s,n){super(),this.name=e,this.type=t,this.initializer=s,this.line=n}accept(e){return e.visitVarStmt(this)}toString(){return"Stmt.Var"}}class J extends A{constructor(e,t,s){super(),this.condition=e,this.loop=t,this.line=s}accept(e){return e.visitWhileStmt(this)}toString(){return"Stmt.While"}}!function(e){e[e.Null=0]="Null",e[e.Any=1]="Any",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.List=5]="List",e[e.Dictionary=6]="Dictionary",e[e.Object=7]="Object",e[e.Class=8]="Class",e[e.Function=9]="Function",e[e.Lambda=10]="Lambda",e[e.Range=11]="Range",e[e.RegExp=12]="RegExp",e[e.Error=13]="Error",e[e.Iterator=14]="Iterator",e[e.Void=100]="Void",e[e.Return=101]="Return",e[e.Break=102]="Break",e[e.Continue=103]="Continue"}(r||(r={}));class X{constructor(e,t=r.Any){this.type=r.Any,this.value=e,this.type=t}isString(){return this.type===r.String}isNull(){return this.type===r.Null}isBoolean(){return this.type===r.Boolean}isNumber(){return this.type===r.Number}isRange(){return this.type===r.Range}isFunction(){return this.type===r.Function}isClass(){return this.type===r.Class}isLambda(){return this.type===r.Function&&"@"===this.name}isList(){return this.type===r.List}isDictionary(){return this.type===r.Dictionary}isObject(){return this.type===r.Object}isTruthy(){if(this.isNull())return!1;if(this.isBoolean())return Boolean(this.value);if(this.isNumber()&&0===this.value)return!1;if(this.isString()&&0===this.value.toString().length)return!1;if(this.isList()&&0===this.value.length)return!1;if(this.isDictionary()&&0===this.value.size)return!1;if(null===this.value)throw new Error("Unknown error value Any is null");if(void 0===this.value)throw new Error("Unknown error value Any is undefined");return!0}isEqual(e){return this.value===e.value}isKeyValue(){return this.type===r.Class||this.type===r.Dictionary||this.type===r.Object}get(e){throw conzole.error(`key ${e} does not exist in ${this}`),new Error("Error in Any getter")}set(e,t){throw conzole.error(`key ${e} does not exist in ${this}`),new Error("Error in Any setter")}toString(){return this.value.toString()}}class Y extends X{constructor(e){super(e,r.Boolean)}}class ee extends X{constructor(){super(null),this.type=r.Null}toString(){return"null"}}class te extends X{constructor(e){super(e,r.Number)}toString(){return this.value.toString()}}class se extends X{constructor(e,t,s){super(e,r.Error),this.line=t,this.col=s}toString(){return this.value.toString()}}class ne{constructor(){this.errorLevel=1}parse(e){this.current=0,this.tokens=e,this.errors=[];const t=[];for(;!this.eof();)try{t.push(this.declaration())}catch(e){if(e instanceof se)this.errors.push(`Parse Error (${e.line}:${e.col}) => ${e.value}`);else if(this.errors.push(e),this.errors.length>100)return this.errors.push("Parse Error limit exceeded"),t;this.synchronize()}return t}match(...e){for(const t of e)if(this.check(t))return this.advance(),!0;return!1}advance(){return this.eof()||this.current++,this.previous()}peek(){return this.tokens[this.current]}previous(){return this.tokens[this.current-1]}check(e){return this.peek().type===e}eof(){return this.check(n.Eof)}consume(e,t){return this.check(e)?this.advance():this.error(this.previous(),t+`, unexpected token "${this.peek().lexeme}"`)}extraSemicolon(){const e=this.match(n.Semicolon);if(this.check(n.Semicolon))for(;this.check(n.Semicolon);)this.consume(n.Semicolon,"");return e}error(e,t){throw new se(t,e.line,e.col)}warning(e){if(1===this.errorLevel){const t=this.previous();conzole.warn(`[line (${t.line}) parse warning at "${t.lexeme}"] => ${e}`)}}synchronize(){do{switch(this.peek().type){case n.Class:case n.Function:case n.Var:case n.For:case n.If:case n.While:case n.Do:case n.Print:case n.Return:return void this.advance()}if(this.peek().type===n.Semicolon||this.peek().type===n.RightBrace)return void this.advance();this.advance()}while(!this.eof())}declaration(){return this.match(n.Class)?this.classDeclaration():this.match(n.Function)?this.funcDeclaration("function"):this.match(n.Var)?this.varDeclaration():this.statement()}classDeclaration(){const e=this.consume(n.Identifier,"Expected a class name");let t=null;this.match(n.Extends)&&(t=this.consume(n.Identifier,"Expected a parent name")),this.consume(n.LeftBrace,'Expected open brace "{" after class name');const s=[];for(;!this.check(n.RightBrace)&&!this.eof();)this.check(n.Function)&&this.consume(n.Function,""),s.push(this.funcDeclaration("method"));return this.consume(n.RightBrace,`Expected "}" after class "${e.literal}" methods`),this.extraSemicolon()&&this.warning(`Unnecessary semicolon after class ${e.lexeme} declaration`),new V(e,t,s,e.line)}funcDeclaration(e){const t=this.consume(n.Identifier,`Expected a ${e} name`);return this.funcParamsBody(t,e)}funcParams(e){const t=[];if(!this.check(n.RightParen))do{t.length>=255&&this.error(this.peek(),"Parameter count exceeds 255"),t.push(this.consume(n.Identifier,"Expected a parameter name"))}while(this.match(n.Comma));return this.consume(n.RightParen,`Expected close parenthesis ")" after ${e} parameters`),t}funcParamsBody(e,t){this.consume(n.LeftParen,`Expected open parenthesis "(" after ${t}`);const s=this.funcParams(t);if(this.match(n.LeftBrace)){const t=this.block();return e.type!==n.Lambda&&this.extraSemicolon()&&this.warning(`Unnecessary semicolon after function ${e.lexeme} declaration`),new W(e,s,t,e.line)}if(this.match(n.Arrow)){const t=[];let r;const i=this.previous();return this.check(n.Semicolon)||(r=this.expression()),this.match(n.Semicolon),t.push(new Z(i,r,i.line)),new W(e,s,t,e.line)}this.consume(n.LeftBrace,`Expect "{" before ${t} body`)}varDeclaration(){const e=this.consume(n.Identifier,'Expected a variable name after "var" keyword');let t=null;return this.match(n.Equal)&&(t=this.expression()),this.consume(n.Semicolon,'Expected semicolon ";" after a variable declaration'),new H(e,null,t,e.line)}statement(){return this.match(n.If)?this.ifStatement():this.match(n.Print)?this.printStatement():this.match(n.Do)?this.doWhileStatement():this.match(n.While)?this.whileStatement():this.match(n.For)?this.forStatement():this.match(n.LeftBrace)?new F(this.block(),this.previous().line):this.match(n.Return)?this.returnStatement():this.match(n.Break)?this.breakStatement():this.match(n.Continue)?this.continueStatement():this.expressionStatement()}ifStatement(){const e=this.previous();this.consume(n.LeftParen,'Expected open parenthesis "(" after an "if" keyword');const t=this.expression();this.consume(n.RightParen,'Expected close parenthesis ")" after "if" statement condition');const s=this.statement();let r=null;return this.match(n.Else)&&(r=this.statement()),new K(t,s,r,e.line)}whileStatement(){const e=this.previous();this.consume(n.LeftParen,'Expected open parenthesis "(" after a "while" statement');const t=this.expression();this.consume(n.RightParen,'Expected close parenthesis ")" after "while" condition');const s=this.statement();return new J(t,s,e.line)}forStatement(){const e=this.previous();let t,s,r;this.consume(n.LeftParen,'Expected open parenthesis "(" after a "for" statement'),t=this.match(n.Semicolon)?null:this.match(n.Var)?this.varDeclaration():this.expressionStatement(),this.check(n.Semicolon)||(s=this.expression()),this.consume(n.Semicolon,'Expected semicolon ";" after a "for" statement loop condition'),this.check(n.RightParen)||(r=this.expression()),this.consume(n.RightParen,'Expected semicolon ";" after a "for" stement increment expression');let i=this.statement();return null!==r&&(i=new F([i,new Q(r,e.line)],e.line)),null===s&&(s=new P(new Y(!0),e.line)),i=new J(s,i,e.line),null!==t&&(i=new F([t,i],e.line)),i}doWhileStatement(){const e=this.previous(),t=this.statement();this.consume(n.While,'Expected a "while" condition after "do" statement'),this.consume(n.LeftParen,'Expected open parenthesis "(" after a "while" keyword');const s=this.expression();return this.consume(n.RightParen,'Expected close parenthesis ")" after "while" condition'),this.consume(n.Semicolon,'Expected semicolon ";" after a do while condition'),new G(t,s,e.line)}printStatement(){const e=this.previous(),t=this.expression();return this.consume(n.Semicolon,'Expected semicolon ";" after expression'),new _(t,e.line)}returnStatement(){const e=this.previous();let t=null;return this.check(n.Semicolon)||(t=this.expression()),this.consume(n.Semicolon,'Exected semicolon ";" after return statement'),new Z(e,t,e.line)}breakStatement(){const e=this.previous();return this.consume(n.Semicolon,'Exected semicolon ";" after break statement'),new j(e,e.line)}continueStatement(){const e=this.previous();return this.consume(n.Semicolon,'Exected semicolon ";" after continue statement'),new U(e,e.line)}block(){const e=[];for(;!this.check(n.RightBrace)&&!this.eof();)e.push(this.declaration());return this.consume(n.RightBrace,'Expected close brace "}" after block statement'),e}expressionStatement(){const e=this.expression();if(this.consume(n.Semicolon,`Expected semicolon ";" after ${e} expression`),this.match(n.Semicolon)){const e=this.previous();for(this.warning(`[line (${e.line}) parse warning at "${e.lexeme}"] => unnecessary semicolon or empty statement`);this.match(n.Semicolon););}return new Q(e,e.line)}expression(){return this.assignment()}assignment(){const e=this.ternary();if(this.match(n.Equal,n.PlusEqual,n.MinusEqual,n.StarEqual,n.SlashEqual)){const t=this.previous();let s=this.assignment();if(e instanceof D){const r=e.name;return t.type!==n.Equal&&(s=new m(new D(r,r.line),t,s,t.line)),new h(r,s,r.line)}if(e instanceof f)return t.type!==n.Equal&&(s=new m(new f(e.entity,e.key,e.type,e.line),t,s,t.line)),new T(e.entity,e.key,s,e.line);this.error(t,"Invalid l-value, is not an assigning target.")}return e}ternary(){const e=this.nullCoalescing();if(this.match(n.Question)){const t=this.ternary();this.consume(n.Colon,'Expected ":" after ternary ? expression');const s=this.ternary();return new M(e,t,s,e.line)}return e}nullCoalescing(){const e=this.logicalOr();if(this.match(n.QuestionQuestion)){const t=this.nullCoalescing();return new B(e,t,e.line)}return e}logicalOr(){let e=this.logicalAnd();for(;this.match(n.Or);){const t=this.previous(),s=this.logicalAnd();e=new k(e,t,s,t.line)}return e}logicalAnd(){let e=this.equality();for(;this.match(n.And);){const t=this.previous(),s=this.equality();e=new k(e,t,s,t.line)}return e}equality(){let e=this.instanceof();for(;this.match(n.BangEqual,n.EqualEqual);){const t=this.previous(),s=this.instanceof();e=new m(e,t,s,t.line)}return e}instanceof(){let e=this.in();for(;this.match(n.Is,n.Instanceof);){const t=this.previous();if(this.match(n.Identifier,n.Class,n.Function,n.Null)){const s=this.previous();e=t.type===n.Instanceof?new g(e,s,t.line):new E(e,s,t.line)}else this.error(this.previous(),'Expected a Type or ClassName identifier after "is" operator')}return e}in(){let e=this.comparison();for(;this.match(n.In);){const t=this.previous(),s=this.expression();e=new x(e,s,t.line)}return e}comparison(){let e=this.addition();for(;this.match(n.Greater,n.GreaterEqual,n.Less,n.LessEqual);){const t=this.previous(),s=this.addition();e=new m(e,t,s,t.line)}return e}addition(){let e=this.modulus();for(;this.match(n.Minus,n.Plus);){const t=this.previous(),s=this.modulus();e=new m(e,t,s,t.line)}return e}modulus(){let e=this.multiplication();for(;this.match(n.Percent);){const t=this.previous(),s=this.multiplication();e=new m(e,t,s,t.line)}return e}multiplication(){let e=this.typeof();for(;this.match(n.Slash,n.Star);){const t=this.previous(),s=this.typeof();e=new m(e,t,s,t.line)}return e}typeof(){if(this.match(n.Typeof)){const e=this.previous(),t=this.typeof();return new N(t,e.line)}return this.unary()}unary(){if(this.match(n.Minus,n.Bang,n.Dollar,n.PlusPlus,n.MinusMinus)){const e=this.previous(),t=this.unary();return new I(e,t,e.line)}return this.newKeyword()}newKeyword(){if(this.match(n.New)){const e=this.previous(),t=this.call();return new L(t,e.line)}return this.call()}call(){let e=this.primary(),t=!0;do{if(t=!1,this.match(n.LeftParen)){t=!0;do{const t=[];if(!this.check(n.RightParen))do{t.push(this.expression())}while(this.match(n.Comma));const s=this.consume(n.RightParen,'Expected ")" after arguments');e=new d(e,s,t,null,s.line)}while(this.match(n.LeftParen))}this.match(n.Dot,n.QuestionDot)&&(t=!0,e=this.dotGet(e,this.previous())),this.match(n.LeftBracket)&&(t=!0,e=this.bracketGet(e,this.previous()))}while(t);return e}dotGet(e,t){const s=this.consume(n.Identifier,"Expect property name after '.'"),r=new S(s,s.line);return new f(e,r,t.type,s.line)}bracketGet(e,t){let s=null,r=null,i=null;if(this.check(n.Colon)||(s=this.expression()),this.match(n.Colon)&&!this.check(n.Colon)&&(r=this.expression()),this.match(n.Colon)&&!this.check(n.RightBracket)&&(i=this.expression()),this.consume(n.RightBracket,'Expected "]" after an index'),!s||r||i){const n=new R(s,r,i,t.line);return new f(e,n,t.type,t.line)}return new f(e,s,t.type,t.line)}primary(){if(this.match(n.False))return new P(new Y(!1),this.previous().line);if(this.match(n.True))return new P(new Y(!0),this.previous().line);if(this.match(n.Null))return new P(new ee,this.previous().line);if(this.match(n.Number))return new P(new te(this.previous().literal),this.previous().line);if(this.match(n.String))return new z(this.previous().literal,this.previous().line);if(this.match(n.Template))return new $(this.previous().literal,this.previous().line);if(this.match(n.Regex))return new q(this.previous().literal,this.previous().line);if(this.match(n.Base)){const e=this.previous();return e.lexeme="this",new p(e,e.line)}if(this.match(n.Identifier)){const e=this.previous();return this.match(n.PlusPlus)?new C(e,1,e.line):this.match(n.MinusMinus)?new C(e,-1,e.line):new D(e,e.line)}if(this.match(n.LeftParen)){const e=this.expression();return this.consume(n.RightParen,'Expected ")" after expression'),new w(e,e.line)}if(this.match(n.LeftBrace))return this.dictionary();if(this.match(n.Function)){const e=new i(n.Lambda,"@","@",this.previous().line,this.previous().col),t=this.funcParamsBody(e,"lambda");return new y(t,e.line)}if(this.match(n.LeftBracket))return this.list();if(this.match(n.Void)){const e=this.expression();return new O(e,this.previous().line)}throw this.error(this.peek(),`Expected expression, unexpected token "${this.peek().lexeme}"`)}dictionary(){const e=this.previous();if(this.match(n.RightBrace))return new v([],this.previous().line);const t=[];do{if(this.match(n.String,n.Identifier,n.Number)){const e=this.previous();this.consume(n.Colon,'Expected ":" colon after member');const s=this.expression();t.push(new T(null,new S(e,e.line),s,e.line))}else this.error(this.peek(),`String, Number or Identifier expected as a Key of Dictionary {, unexpected token ${this.peek().lexeme}`)}while(this.match(n.Comma));return this.consume(n.RightBrace,'Expected "}" after object literal'),new v(t,e.line)}list(){const e=[],t=this.previous();if(this.match(n.RightBracket))return new b([],this.previous().line);do{e.push(this.expression())}while(this.match(n.Comma));return this.consume(n.RightBracket,'Expected "]" after array declaration'),new b(e,t.line)}}class re{constructor(e=null){this.values=new Map,this.parent=e}error(e){throw new Error(`Runtime Error => ${e}`)}set(e,t){this.values.set(e,t)}define(e,t){this.values.has(e)?this.error(`Identifier "${e}" has already been defined`):this.set(e,t)}assign(e,t){if(this.values.has(e))this.set(e,t);else{if(null!==this.parent)return this.parent.assign(e,t);this.error(`Identifier "${e}" has not been defined`)}}get(e,t=null){return this.values.has(e)?this.values.get(e):null!==this.parent?this.parent.get(e):(t?this.error(` at (${t.line}:${t.col}) => "${t.lexeme}" is not defined`):this.error(`"${e}" is not defined`),new ee)}}class ie extends X{constructor(e,t,s){super(s,r.Function),this.arity=t,this.name=e}call(e,t,s){return this.value(e,t,s)}toString(){return`<${this.name}  function>`}}class ae extends ie{constructor(e,t){super(e.name.lexeme,e.params.length,null),this.declaration=e,this.closure=t}call(e,t,s){const n=new re(this.closure);for(let e=0;e<this.declaration.params.length;e++)n.define(this.declaration.params[e].lexeme,t[e]);n.set("this",e);let i=null;try{i=s.scope,s.executeBlock(this.declaration.body,n)}catch(e){if(e instanceof X&&e.type===r.Return)return i&&(s.scope=i),e.value;throw e}return new ee}}class oe extends X{constructor(e){super(e,r.String)}get(e){return e.isNumber()?new oe(this.value[e.value]):e.isRange()?this.range(e):oe.runtime.has(e.value)?oe.runtime.get(e.value):new ee}set(e,t){return new ee}toString(){return`${this.value}`}range(e){let t="";return e.iterate(this.value.length,e=>{t+=this.value[e]}),new oe(t)}static replace(e,t,s){return t[1].isFunction()?e.value.replace(t[0].value,n=>t[1].call(e,[new oe(n)],s).value):new oe(e.value.replace(t[0].value,t[1].value))}}oe.runtime=new Map([["toUpper",de("toUpperCase",0,r.String)],["toLower",de("toLowerCase",0,r.String)],["size",new ie("size",0,(e,t)=>new te(e.value.length))],["split",de("split",1,r.List)],["concat",de("concat",1,r.String)],["includes",de("includes",1,r.Boolean)],["indexOf",de("indexOf",1,r.Number)],["lastIndexOf",de("lastIndexOf",1,r.Number)],["repeat",de("repeat",1,r.String)],["replace",new ie("replace",-1,oe.replace)],["search",de("search",1,r.Number)],["slice",de("slice",-1,r.String)],["substring",de("substring",-1,r.String)],["trim",de("trim",0,r.String)]]);class ue extends X{constructor(e){super(e,r.Dictionary)}get(e){return this.value.has(e.value)?this.value.get(e.value):ue.runtime.has(e.value)?ue.runtime.get(e.value):new ee}set(e,t){return this.value.set(e.value,t),t}toString(){const e=[];return this.value.forEach((t,s)=>{e.push(`${s.toString()}: ${t}`)}),`{${e.join("; ")}}`}static each(e,t,s){return e.value.forEach((n,r)=>{t[0].call(e,[n,new oe(r),e],s)}),e}static map(e,t,s){return e.value.forEach((n,r)=>{e.value.set("key",t[0].call(e,[n,new oe(r),e],s))}),e}static indexOf(e,t,s){let n=null;return e.value.forEach((e,s)=>{e.type===t[0].type&&e.value===t[0].value&&(n=s)}),null!==n?new oe(n):new ee}static iterator(e,t,s){return new ce(e)}static next(e){const t=e,s=t.value;if(!s.value.size)return t.complete(),t;null===t.iter.inner&&(t.iter.inner=s.value.keys());const n=t.iter.inner.next();return t.iter.value=n.value,n.done&&t.complete(),t}}ue.runtime=new Map([["clear",de("clear",0,r.Null)],["delete",de("delete",1,r.Boolean)],["each",new ie("each",1,ue.each)],["has",de("has",1,r.Boolean)],["indexOf",new ie("indexOf",1,ue.indexOf)],["map",new ie("map",1,ue.map)],["merge",new ie("merge",1,(e,t)=>new ue(new Map([...e.value,...t[0].value])))],["size",new ie("size",0,(e,t)=>new te(e.value.size))],["iterator",new ie("iterator",0,ue.iterator)],["next",new ie("next",0,ue.next)]]);class le{constructor(e,t,s,n){this.value=e,this.index=t,this.done=s,this.inner=n}}class ce extends X{constructor(e){super(e,r.RegExp),this.iter=new le(new ee,new ee,new Y(!1),null)}get(e){return"key"===e.value||"index"===e.value?this.iter.index:"done"===e.value?this.iter.done:"value"===e.value?this.iter.value:ce.runtime.has(e.value)?ce.runtime.get(e.value):new ee}complete(){this.iter.done=new Y(!0),this.iter.value=new ee,this.iter.index=new ee}set(e,t){return void 0!==this.iter[e.value]&&(this.iter[e.value]=t),t}toString(){return`<${r[this.value.value.type]} iterator>`}static next(e,t,s){const n=e;return n.value.isList()&&he.next(e),n.value.isDictionary()&&ue.next(e),n.value.isObject()&&e.value.get(s.strings.next).call(e.value,[e],s),n}static first(e,t,s){return e.value.value.isList()?new ue(new Map([["key",0],["value",e.value.value[0]]])):new ee}}ce.runtime=new Map([["first",new ie("first",0,ce.first)],["next",new ie("next",0,ce.next)]]);class he extends X{constructor(e){super(e,r.List)}get(e){return e.isNumber()?void 0!==this.value[e.value]?this.value[e.value]:new ee:e.isRange()?this.range(e):he.runtime.has(e.value)?he.runtime.get(e.value):new ee}set(e,t){return e.isNumber()&&(this.value[e.value]=t),t}range(e){const t=[];return e.iterate(this.value.length,e=>{t.push(this.value[e])}),new he(t)}toString(){return`[${this.value.join(",")}]`}static size(e,t){return new te(t[0].value.length)}static each(e,t,s){for(let n=0;n<e.value.length;++n)t[0].call(e,[e.value[n],new te(n),e],s);return e}static map(e,t,s){for(let n=0;n<e.value.length;++n)e.value[n]=t[0].call(e,[new X(e.value[n]),new te(n),e],s);return e}static iterator(e,t,s){return new ce(e)}static next(e){const t=e,s=t.value,n=t.iter.index;if(!s.value.length)return t.complete(),t;if(null===t.iter.inner)return t.iter.inner=!0,t.iter.index=new te(0),t.iter.value=s.value[0],t;if(t.iter.done.value)return t;if(n.value>=s.value.length-1)return t.complete(),t;const r=n.value+1;return t.iter.index=new te(r),t.iter.value=s.value[r],t}}he.runtime=new Map([["concat",de("concat",-1,r.List)],["each",new ie("each",1,he.each)],["includes",de("includes",1,r.Boolean)],["indexOf",de("indexOf",1,r.Number)],["join",de("join",1,r.String)],["lastIndexOf",de("lastIndexOf",1,r.Number)],["map",new ie("map",1,he.map)],["pop",de("pop",0,r.List)],["push",de("push",-1,r.List)],["shift",de("shift",0,r.List)],["size",new ie("size",0,(e,t)=>new te(e.value.length))],["slice",de("slice",-1,r.List)],["splice",de("splice",-1,r.List)],["unshift",de("unshift",-1,r.List)],["iterator",new ie("iterator",0,he.iterator)]]);class pe extends X{constructor(e){super(e,r.Void)}}class me extends X{constructor(e){super(e,r.RegExp)}}function de(e,t,s){return new ie(e,t,(t,n)=>{const i=n.map(e=>e.value),a=t.value[e](...i);switch(s){case r.Boolean:return new Y(a);case r.String:return new oe(a);case r.Number:return new te(a);case r.List:return new he(a);case r.Null:return new ee;default:return new X(a)}})}function ve(e,t,s){return new ie(t,s,(t,s)=>{const n=s.map(e=>e.value),r=e(...n);return new te(r)})}function fe(e,t,s){return new ie(t,s,(t,s)=>{const n=s.map(e=>e.value);return e(...n),new pe("void")})}const we={Console:new Map([["log",fe(console.log,"console.log",-1)],["warn",fe(console.warn,"console.warn",-1)],["info",fe(console.info,"console.info",-1)],["error",fe(console.error,"console.error",-1)]]),Math:new Map([["ceil",ve(Math.ceil,"ceil",1)],["cos",ve(Math.cos,"cos",1)],["floor",ve(Math.floor,"floor",1)],["log",ve(Math.log,"log",1)],["max",ve(Math.max,"max",-1)],["min",ve(Math.min,"min",-1)],["pi",new te(Math.PI)],["pow",ve(Math.pow,"pow",2)],["random",ve(Math.random,"random",0)],["round",ve(Math.round,"round",1)],["sin",ve(Math.sin,"sin",1)],["sqrt",ve(Math.sqrt,"sqrt",1)],["tan",ve(Math.tan,"tan",1)],["trunc",ve(Math.trunc,"trunc",1)]]),Utils:new Map([["re",new ie("regex",-1,(e,t)=>{const s=t.map(e=>e.value);return 1===s.length?new me(new RegExp(s[0])):new me(new RegExp(s[0],s[1]))})],["iter",new ie("iter",1,(e,t)=>new ce(t[0]))]])};class xe extends X{constructor(e,t,s){super(t,r.Class),this.name=e,this.parent=s}get(e){return this.value.has(e.value)?this.value.get(e.value):this.parent.isClass()?this.parent.get(e):new ee}set(e,t){return this.value.set(e.value,t),t}toString(){return`<${this.name} class>`}}class ge extends X{constructor(e,t){super(e,r.Object),this.conztructor=t,this.name=t.name}get(e){const t=this.conztructor.get(e);return t.isFunction()?t:this.value.has(e.value)?this.value.get(e.value):new ee}set(e,t){return this.value.set(e.value,t),t}toString(){return`<${this.name} object>`}}class Ee{constructor(e,t,s){this.start=e,this.end=t,this.step=s}normalize(e){null===this.step&&(this.step=1),null===this.end&&(this.end=this.step>0?e-1:0),null===this.start&&(this.start=this.step>0?0:e-1)}}class Se extends X{constructor(e){super(e,r.Range)}iterate(e,t){if(this.value.normalize(e),this.value.step>0)for(let e=this.value.start;e<=this.value.end;e+=this.value.step)t(e);else if(this.value.step<0)for(let e=this.value.start;e>=this.value.end;e+=this.value.step)t(e);else conzole.warn("[range error] => 0 is not a valid step")}}class ye{constructor(){this.global=new re,this.scope=this.global,this.errors=[],this.scanner=new l,this.parser=new ne,this.strings={next:new oe("next")},this.global.set("math",new ue(we.Math)),this.global.set("console",new ue(we.Console)),this.global.set("re",we.Utils.get("re")),this.global.set("iter",we.Utils.get("iter")),this.parser.errorLevel=0}evaluate(e){return e.result=e.accept(this)}execute(e){return e.result=e.accept(this)}eval(e){try{return{error:!1,value:e.accept(this).toString()}}catch(e){return{error:!0,value:e.message}}}interpet(e){this.errors=[];for(const t of e)try{this.execute(t)}catch(t){if(conzole.error(t.message),this.errors.push(t.message),this.errors.length>100)return this.errors.push("Runtime Error limit exceeded"),e}return e}error(e){throw new Error(`Runtime Error => ${e}`)}visitExpressionStmt(e){return this.evaluate(e.expression)}visitPrintStmt(e){const t=this.evaluate(e.expression);return conzole.log(t.toString()),t}visitVarStmt(e){let t=new ee;return null!==e.initializer&&(t=this.evaluate(e.initializer)),t.isLambda()&&(t.name=e.name.lexeme),this.scope.define(e.name.lexeme,t),t}visitVariableExpr(e){return this.scope.get(e.name.lexeme,e.name)}visitPostfixExpr(e){const t=this.scope.get(e.name.lexeme,e.name),s=new te(t.value+e.increment);return this.scope.assign(e.name.lexeme,s),t}visitListExpr(e){const t=[];for(const s of e.value)t.push(this.evaluate(s));return new he(t)}visitZtringExpr(e){return new oe(e.value)}templateParse(e){const t=this.scanner.scan(e),s=this.parser.parse(t);this.parser.errors.length&&this.error(`Template string  error: ${this.parser.errors[0]}`);let n="";for(const e of s)n+=this.execute(e).toString();return n}visitTemplateExpr(e){const t=e.value.replace(/\$\{\{([\s\S]+?)\}\}/g,(e,t)=>(";"!==t[t.length]&&(t+=";"),this.templateParse(t)));return new oe(t)}visitRegExExpr(e){return new ee}visitAssignExpr(e){const t=this.evaluate(e.value);return this.scope.assign(e.name.lexeme,t),t}visitBinaryExpr(e){const t=this.evaluate(e.left),s=this.evaluate(e.right);switch(e.operator.type){case n.Minus:case n.MinusEqual:return new te(t.value-s.value);case n.Slash:case n.SlashEqual:return new te(t.value/s.value);case n.Star:case n.StarEqual:return new te(t.value*s.value);case n.Percent:case n.PercentEqual:return new te(t.value%s.value);case n.Plus:case n.PlusEqual:return t.isNumber()&&s.isNumber()?new te(t.value+s.value):t.isString()&&s.isString()?new oe(t.value+s.value):t.isList()&&s.isList()?new he(t.value.concat(s.value)):t.isDictionary()&&s.isDictionary()?new ue(new Map([...t.value,...s.value])):new oe(t.toString()+s.toString());case n.Pipe:return new te(t.value|s.value);case n.Caret:return new te(t.value^s.value);case n.Greater:return new Y(t.value>s.value);case n.GreaterEqual:return new Y(t.value>=s.value);case n.Less:return new Y(t.value<s.value);case n.LessEqual:return new Y(t.value<=s.value);case n.EqualEqual:return new Y(t.value===s.value);case n.BangEqual:return new Y(t.value!==s.value);default:return this.error("Unknown binary operator "+e.operator),new ee}}visitLogicalExpr(e){const t=this.evaluate(e.left);if(e.operator.type===n.Or){if(t.isTruthy())return t}else if(!t.isTruthy())return t;return this.evaluate(e.right)}visitTernaryExpr(e){return this.evaluate(e.condition).isTruthy()?this.evaluate(e.thenExpr):this.evaluate(e.elseExpr)}visitNullCoalescingExpr(e){const t=this.evaluate(e.left);return t.isNull()?this.evaluate(e.right):t}visitGroupingExpr(e){return this.evaluate(e.expression)}visitLiteralExpr(e){return e.value}visitUnaryExpr(e){const t=this.evaluate(e.right);switch(e.operator.type){case n.Minus:return new te(-Number(t.value));case n.Bang:return new Y(!t.isTruthy());case n.PlusPlus:case n.MinusMinus:t.isNumber()||this.error(`Invalid right-hand side expression in prefix operation:  "${r[t.type]} ${t} is not a number`);const s=Number(t.value)+(e.operator.type===n.PlusPlus?1:-1);if(e.right instanceof D)this.scope.assign(e.right.name.lexeme,new te(s));else if(e.right instanceof f){const t=new T(e.right.entity,e.right.key,new P(new te(s),e.line),e.line);this.evaluate(t)}else this.error(`Invalid right-hand side expression in prefix operation:  ${e.right}`);return new te(s);default:return this.error("Unknown unary operator ' + expr.operator"),new ee}}executeBlock(e,t){const s=this.scope;this.scope=t;for(const t of e)t.result=this.execute(t);return this.scope=s,new pe("block")}visitBlockStmt(e){return this.executeBlock(e.statements,new re(this.scope))}visitIfStmt(e){return this.evaluate(e.condition).isTruthy()?this.execute(e.thenStmt):null!==e.elseStmt?this.execute(e.elseStmt):void 0}visitWhileStmt(e){for(;this.evaluate(e.condition).isTruthy();)try{this.execute(e.loop)}catch(e){if(e instanceof X&&e.type===r.Break)break;if(e instanceof X&&e.type===r.Continue)continue;throw e}return new pe("while")}visitDoWhileStmt(e){do{try{this.execute(e.loop)}catch(e){if(e instanceof X&&e.type===r.Break)break;if(e instanceof X&&e.type===r.Continue)continue;throw e}}while(this.evaluate(e.condition).isTruthy());return new pe("dowhile")}visitCallExpr(e){const t=this.evaluate(e.callee);t.isFunction()||this.error(`${t} is not a function`);let s=null;e.callee instanceof f?s=e.callee.entity instanceof p?this.scope.get("this",e.paren):this.evaluate(e.callee.entity):null!==e.thiz&&(s=e.thiz);const n=[];for(const t of e.args)n.push(this.evaluate(t));const r=t;if(n.length!==r.arity&&-1!==r.arity&&(conzole.warn(`Warning at (${e.paren.line}): ${t} mismatched argument count; \n Expected ${r.arity} but got ${n.length} `),n.length<r.arity))for(let e=n.length;e<=r.arity;++e)n.push(new ee);return r.call(s,n,this)}visitBaseExpr(e){const t=this.scope.get(e.paren.lexeme,e.paren);t.isObject()||this.error("base expression can be used only inside methods");const s=t.conztructor,n=s.parent;return n.isNull()&&this.error("Class "+s+" has not been extended and has no base"),n}visitNewExpr(e){const t=e.clazz,s=this.evaluate(t.callee);s.isClass()||this.error(`'${s}' is not a class. 'new' statement must be used with classes.`);const r=new ge(new Map,s),i=s.get(new oe("constructor"));return i.isFunction()&&this.evaluate(new d(new f(new P(r,e.line),new S(i.declaration.name,e.line),n.Dot,e.line),i.declaration.name,t.args,r,e.line)),r}visitDictionaryExpr(e){const t=new ue(new Map);for(const s of e.properties){const e=this.evaluate(s.key),n=this.evaluate(s.value);t.set(e,n)}return t}visitKeyExpr(e){return new X(e.name.literal)}visitGetExpr(e){const t=this.evaluate(e.entity),s=this.evaluate(e.key);return t.isNull()&&e.type===n.QuestionDot?new ee:t.get(s)}visitSetExpr(e){const t=this.evaluate(e.entity),s=this.evaluate(e.key),n=this.evaluate(e.value);return t.set(s,n),n.value}visitFuncStmt(e){const t=new ae(e,this.scope);return this.scope.define(e.name.lexeme,t),t}visitClassStmt(e){let t;t=null===e.parent?new ee:this.scope.get(e.parent.lexeme,e.parent);const s=new Map;for(const t of e.methods)s.set(t.name.lexeme,new ae(t,this.scope));const n=new xe(e.name.lexeme,s,t);return this.scope.define(e.name.lexeme,n),n}visitLambdaExpr(e){const t=e.lambda;return new ae(t,this.scope)}visitReturnStmt(e){let t=new ee;throw e.value&&(t=this.evaluate(e.value)),new X(t,r.Return)}visitBreakStmt(e){throw new X(null,r.Break)}visitContinueStmt(e){throw new X(null,r.Continue)}visitRangeExpr(e){return new Se(new Ee(e.start?this.evaluate(e.start).value:null,e.end?this.evaluate(e.end).value:null,e.step?this.evaluate(e.step).value:null))}visitTypeofExpr(e){const t=this.evaluate(e.value);return new oe(r[t.type].toLowerCase())}visitIsExpr(e){const t=this.evaluate(e.left),s=r[u(e.right.lexeme)];return t.isObject()&&t.name===e.right.lexeme?new Y(!0):void 0===s||isNaN(s)?new Y(!1):new Y(t.type===s)}visitInstanceOfExpr(e){const t=this.evaluate(e.left);if(!t.isObject())return new Y(!1);const s=e.right.lexeme;if("object"===s.toLowerCase())return new Y(!0);let n=t.conztructor;if(n.name===s)return new Y(!0);for(;!n.parent.isNull();)if((n=n.parent).name===s)return new Y(!0);return new Y(!1)}visitVoidExpr(e){return this.evaluate(e.value),new ee}visitInExpr(e){const t=this.evaluate(e.key),s=this.evaluate(e.entity);return s.isKeyValue()?new Y(s.value.has(t.value)):s.isList()?new Y(void 0!==s.value[t.value]):s.isString()?new Y(s.value.includes(t.value)):(this.error(`Operator "in" can't be used on type ${r[s.type]} with value "${s}"`),new ee)}}var ke;!function(e){e[e.User=0]="User",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Info=3]="Info"}(ke||(ke={}));class be{constructor(){this.messages=[]}add(e,t){this.messages.push({text:e,time:new Date,type:t})}clear(){this.messages=[]}log(e){this.add(e,ke.User)}warn(e){this.add(e,ke.Warning)}error(e){this.add(e,ke.Error)}info(e){this.add(e,ke.Info)}first(){return this.messages[0].text}last(){return this.messages[this.messages.length-1].text}print(){return console.log(this.messages.map(e=>e.text))}}const Pe={execute:e=>{const t=new l,s=new ne,n=new ye,r=t.scan(e);if(t.errors.length)return t.errors.forEach(e=>{window.conzole.error(e)}),[];const i=s.parse(r);return s.errors.length?(s.errors.forEach(e=>{window.conzole.error(e)}),[]):n.interpet(i)},interpreter:ye,parser:ne,scanner:l};"undefined"!=typeof window?(window.conzole=new be,window.demoSourceCode="\n//\nvar d = {\n    'one': 1,\n    'two': 2,\n    'three': 3,\n    'four': 4\n};\nvar it = d.iterator();\nwhile (!it.done) {\n    it.next();\n    print it.value;\n}\n\n",window.atscript=Pe):exports.atscript=Pe}]);